<!DOCTYPE html>
<html>
<head>
    <title>SMART HOME</title>
</head>
<body>
    <h1>SMART HOME</h1>

    <button onclick="openDoor()">Open Door</button>
    <button onclick="lightOn()">Light ON</button>
    <button onclick="lightOff()">Light OFF</button>

    <h2>Logs</h2>
    <ul id="logs"></ul>

<script>
function openDoor() {
    fetch("/door", { method: "POST" })
    .then(r => r.text())
    .then(d => console.log(d));
}

function lightOn() {
    fetch("/light", {
        method: "POST",
        headers: {"Content-Type": "application/x-www-form-urlencoded"},
        body: "state=ON"
    });
}

function lightOff() {
    fetch("/light", {
        method: "POST",
        headers: {"Content-Type": "application/x-www-form-urlencoded"},
        body: "state=OFF"
    });
}

function loadLogs() {
    fetch("/logs")
    .then(res => res.json())
    .then(data => {
        let ul = document.getElementById("logs");
        ul.innerHTML = "";
        data.forEach(log => {
            ul.innerHTML += `<li>${log.time} - ${log.user} - ${log.action}</li>`;
        });
    });
}

setInterval(loadLogs, 2000);
loadLogs();
</script>
</body>
</html>
